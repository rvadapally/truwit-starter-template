<form [formGroup]="verificationForm" (ngSubmit)="onSubmit()" class="verification-form">
  
  <!-- Status Messages - Moved to be near the form -->
  <div class="status-messages" *ngIf="errorMessage || successMessage || isVerifying">
    <!-- Loading State -->
    <div class="status-message loading" *ngIf="isVerifying">
      <div class="spinner"></div>
      <div class="loading-content">
        <span class="loading-title">üîÑ Verifying Your Content</span>
        <span class="loading-subtitle">{{ verificationStep }}</span>
        <div class="progress-bar">
          <div class="progress-fill"></div>
        </div>
      </div>
    </div>
    
    <!-- Success Message -->
    <div class="status-message success" *ngIf="successMessage">
      <div class="success-content">
        <div class="success-icon">üéâ</div>
        <div class="success-text">
          <span class="success-title">Proof Created Successfully!</span>
          <span class="success-subtitle">{{ successMessage }}</span>
          <div class="success-actions" *ngIf="createdProof">
            <button class="btn-primary" (click)="visitVerificationPage()">
              View Verification Details
            </button>
            <button class="btn-secondary" (click)="resetForm()">
              Create Another Proof
            </button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Error Message -->
    <div class="status-message error" *ngIf="errorMessage">
      <div class="error-content">
        <div class="error-icon">‚ö†Ô∏è</div>
        <div class="error-text">
          <span class="error-title">Verification Failed</span>
          <span class="error-subtitle">{{ errorMessage }}</span>
        </div>
      </div>
    </div>
  </div>

  <div class="form-section" *ngIf="!createdProof">
    <h3 class="section-title">Video Content Verification</h3>
    
    <!-- URL Input -->
    <div class="input-group">
      <label class="input-label">Paste URL</label>
      <div class="url-input-container">
        <input 
          type="url" 
          formControlName="url"
          placeholder="https://example.com/video.mp4" 
          class="url-input"
          [disabled]="isVerifying"
          (input)="onUrlChange()">
        <button 
          type="button" 
          class="btn-url-verify"
          [disabled]="!verificationForm.get('url')?.valid || isVerifying"
          (click)="onSubmit()">
          Verify URL
        </button>
      </div>
      <div class="url-help-text">
        <small>Click "Verify URL" to check if the URL is valid, or scroll down to "Generate Proof" to create a verification proof</small>
      </div>
    </div>

    <div class="divider">or</div>

    <!-- File Upload -->
    <div class="input-group">
      <label class="input-label">Upload video file</label>
              <input 
                type="file" 
                class="file-input"
                accept="video/*,.mp4,.mov,.avi,.mkv,.webm,.m4v,.3gp,.flv,.wmv"
                [disabled]="isVerifying"
                (change)="onFileSelected($event)">
      <div class="file-info" *ngIf="selectedFile">
        Selected: {{ selectedFile.name }} ({{ formatFileSize(selectedFile.size) }})
      </div>
    </div>
  </div>

  <!-- Metadata Section -->
  <div class="form-section" *ngIf="!createdProof">
    <h3 class="section-title">Metadata (Optional)</h3>
    
    <div class="metadata-grid">
      <div class="input-group">
        <label class="input-label">Prompt Used</label>
        <textarea 
          formControlName="prompt"
          placeholder="Describe the prompt used to generate this content..."
          class="textarea-input"
          [disabled]="isVerifying"
          rows="3">
        </textarea>
      </div>

      <div class="input-group">
        <label class="input-label">Tool Name</label>
        <input 
          type="text" 
          formControlName="toolName"
          placeholder="e.g., Sora, Midjourney, DALL-E"
          class="text-input"
          [disabled]="isVerifying">
      </div>

      <div class="input-group">
        <label class="input-label">Tool Version</label>
        <input 
          type="text" 
          formControlName="toolVersion"
          placeholder="e.g., v2, 5.2"
          class="text-input"
          [disabled]="isVerifying">
      </div>

      <div class="input-group">
        <label class="input-label">License Type</label>
        <select formControlName="license" class="select-input" [disabled]="isVerifying">
          <option *ngFor="let license of licenseTypes" [value]="license.value">
            {{ license.label }}
          </option>
        </select>
      </div>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="form-actions" *ngIf="!createdProof">
    <div class="action-section">
      <h4 class="action-title">Ready to Create Proof?</h4>
      <p class="action-description">Generate a cryptographic proof for your content</p>
      <div class="action-buttons">
        <button 
          type="submit" 
          class="btn-generate-proof"
          [disabled]="verificationForm.invalid || isVerifying">
          <span *ngIf="isVerifying">Creating Proof...</span>
          <span *ngIf="!isVerifying">üöÄ Generate Proof</span>
        </button>
        <button 
          type="button" 
          class="btn-secondary"
          (click)="resetForm()"
          [disabled]="isVerifying">
          Reset Form
        </button>
      </div>
    </div>
  </div>
</form>
